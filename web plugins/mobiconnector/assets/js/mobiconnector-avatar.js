jQuery(function ($) {
    var custom_uploader; $('#mobiconnector-button-input-image').click(function (e) {
        var id_img_input = $('#mobiconnector-user-avatar'); var img_input = $('#mobiconnector-user-avatar-url'); e.preventDefault(); if (custom_uploader) { custom_uploader.open(); return; }
        custom_uploader = wp.media.frames.file_frame = wp.media({ title: 'Save Image', button: { text: 'Save Image' }, multiple: false }); custom_uploader.on('select', function () { var selection = custom_uploader.state().get('selection'); selection.map(function (attachment) { attachment = attachment.toJSON(); var urlsm = attachment.url; var id = attachment.id; var checkimage = urlsm.split('.').pop().toUpperCase(); if (checkimage.length < 1) { return false; } else if (checkimage != "PNG" && checkimage != "JPG" && checkimage != "GIF" && checkimage != "JPEG") { alert("invalid extension " + checkimage); return false; } else { img_input.val(urlsm); id_img_input.val(id); $('.mobiconnector-avatar').attr('src', urlsm); $('#mobiconnector-button-delete-image').css('display', 'block'); } }); }); custom_uploader.open(); return false;
    }); $('#mobiconnector-button-delete-image').click(function (e) { var default_avatar = mobiconnector_avatar_js_params.default_avatar; if (confirm('Are you sure you want to delete this thing?')) { $('#mobiconnector-user-avatar').val(''); $('#mobiconnector-user-avatar-url').val(''); $('.mobiconnector-avatar').attr('src', default_avatar); $('#mobiconnector-button-delete-image').css('display', 'none'); } else { return false; } })
    $(window).load(function () { var width = $('.mobiconnector-avatar').width(); $('#mobiconnector-images-after-span').css('width', width); })
})