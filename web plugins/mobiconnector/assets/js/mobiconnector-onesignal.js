jQuery(function ($) {
    var params = mobiconnector_settings_onesignal_js_params; $(window).load(function () { $('#mobiconnector-web-content-notification-en').css('display', 'block'); $('#mobiconnector-web-title-notification-en').css('display', 'block'); $('#mobiconnector-web-subtitle-notification-en').css('display', 'block'); })
    $('.select-languages-notification').change(function () { var thelanguage = $(this).val(); $('.mobiconnector-web-input-notification').css('display', 'none'); $('#mobiconnector-web-content-notification-' + thelanguage).css('display', 'block'); $('#mobiconnector-web-title-notification-' + thelanguage).css('display', 'block'); $('#wooconnector-web-subtitle-notification-' + thelanguage).css('display', 'block'); $('.select-languages-notification option[value="' + thelanguage + '"]').attr('selected', 'selected'); })
    $(document).click(function (event) { if (!$(event.target).closest('.mobiconnector-web-url-notification').length) { if ($('.mobiconnector-web-url-notification').is(":visible")) { $('#list-url-notification').hide(); } } })
    $('.symb-support-input').on('mouseover', function (e) { e.preventDefault(); $(this).parent('.support-input').children('.tooltip-support-input').fadeIn(200); })
    $(document).on('mouseout', function (event) { if (!$(event.target).closest('.symb-support-input').length && !$(event.target).closest('.tooltip-support-input').length) { if ($('.symb-support-input').is(":visible") && $('.tooltip-support-input').is(":visible")) { $('.tooltip-support-input').fadeOut(200); } } })
    $(window).load(function () { var selected = $('.select-url-notification').val(); if (selected == 'url-post' || selected == 'url-category') { $('#mobiconnector-web-url-notification-' + selected).show(); } })
    $('.select-url-notification').change(function (e) {
        var selected = $(this).val(); if (selected == 'url-post') { $('#mobiconnector-web-url-notification-url-post').show(); } else { $('#mobiconnector-web-url-notification-url-post').hide(); }
        if (selected == 'url-category') { $('#mobiconnector-web-url-notification-url-category').show(); } else { $('#mobiconnector-web-url-notification-url-category').hide(); }
    })
    $('.mobiconnector-web-url-notification').keyup(function (e) {
        e.preventDefault(); var selected = $('.select-url-notification').val(); if (selected == 'url-post' || selected == 'url-category') {
            $('#list-url-notification').css('display', 'block'); $('#list-url-notification').html('Please enter 3 or more characters'); var value = $(this).val(); if (value.length >= 3) {
                var baseurl = $('#mobiconnector-baseurl').val(); $('#list-url-notification').html(''); var data = { 'action': 'mobiconnector_show_url', 'mobiconnectorvalue': value, 'mobiconnectorselect': selected, 'security': params.security, }
                $.post(params.ajax_url, data, function (response) { $('#list-url-notification').html(''); $('#list-url-notification').html(response); $('.ajax-url-notification').click(function (e) { var urlproduct = $(this).children('.content-url-notification').children('.ajax-link-hidden-url').val(); $('#list-url-notification').css('display', 'none'); $('.mobiconnector-web-url-notification').val(''); $('#mobiconnector-web-url-notification-' + selected).val(urlproduct); }) });
            }
        }
    }); $('#mobiconnector-web-title-notification-en').keyup(function (e) { $('#mobiconnector-privew-title-text').html($(this).val()); })
    $('#mobiconnector-web-content-notification-en').keyup(function (e) { $('#mobiconnector-privew-content-text').html($(this).val()); })
    $('#save-notification, #save-and-send-notification').on('click', function (e) {
        var title = $('#mobiconnector-web-title-notification-en').val(); var content = $('#mobiconnector-web-content-notification-en').val(); if (title == '' || title == null) { $('#mobiconnector-preview-notification').append("<div class='notti-settings-onsignal setting-error'>Please input Title English! </div>"); setTimeout(function (e) { $('.notti-settings-onsignal').hide(); }, 6000); return false; }
        if (content == '' || content == null) { $('#mobiconnector-preview-notification').append("<div class='notti-settings-onsignal setting-error'>Please input Content English! </div>"); setTimeout(function (e) { $('.notti-settings-onsignal').hide(); }, 6000); return false; }
    })
    $('.mobiconnector-web-title-notification').attr('maxlength', 40); var checkicononload = $('#mobiconnector-preview-icon').attr('src'); if (checkicononload == null || checkicononload == '') { $('#mobiconnector-preview-icon').css('display', 'none'); }
    $('#click-open-big-images').click(function (e) { $(this).toggleClass('switchImages'); $('#mobiconnector-preview-text-notification').toggleClass('switchImages'); $('#mobiconnector-preview-icon-notification.small').toggleClass('switchImages'); $('#mobiconnector-big-images-previews').toggleClass('switchImages'); }); $('#sendeveryone').click(function (e) { $('.dropdown-radiosegment').hide(); })
    $('#sendtoparticular').click(function (e) { $('.dropdown-radiosegment').hide(); $('#dropdown-sendtoparticular').fadeIn(); }); $('#sendtotest').click(function (e) { $('.dropdown-radiosegment').hide(); $('#dropdown-sendtotest').fadeIn(); }); $('.list-segment').click(function (e) { $(this).parent('.mobiconnector-dropdown').children('.mutliSelect').slideToggle('fast'); })
    $('.list-segment').click(function (e) { $(this).parent('.mobiconnector-dropdown').children('.mobiconnector-states-multiselect').slideToggle('fast'); })
    $(document).click(function (event) { if (!$(event.target).closest('.mobiconnector-states-multiselect').length && !$(event.target).closest('.list-segment').length) { if ($('.mobiconnector-states-multiselect').is(":visible") && $('.list-segment').is(":visible")) { $('.mobiconnector-states-multiselect').slideUp('fast'); } } })
    $(document).click(function (event) { if (!$(event.target).closest('.mutliSelect').length && !$(event.target).closest('.list-segment').length) { if ($('.mutliSelect').is(":visible") && $('.list-segment').is(":visible")) { $('.mutliSelect').slideUp('fast'); } } })
    $('.list-segment').keypress(function (e) { return false; })
    $('.mutliSelect .mobiconnector-value-dropdown').on('click', function () { var title = $(this).closest('.mutliSelect').find('input[type="checkbox"]').val(), title = $(this).val() + ","; var val = $(this).val(); if (val != 'all') { if ($(this).is(':checked')) { var oldval = $(this).parent('li').parent('ul').parent('.mutliSelect').parent('.mobiconnector-dropdown').children('.symbol-multi-dropdown-setting').val(); var newval = oldval + title; $(this).parent('li').parent('ul').parent('.mutliSelect').parent('.mobiconnector-dropdown').children('.symbol-multi-dropdown-setting').val(newval); } else { var oldval = $(this).parent('li').parent('ul').parent('.mutliSelect').parent('.mobiconnector-dropdown').children('.symbol-multi-dropdown-setting').val(); var newval = oldval.replace(title, ""); $(this).parent('li').parent('ul').parent('.mutliSelect').parent('.mobiconnector-dropdown').children('.symbol-multi-dropdown-setting').val(newval); } } })
    $('.mutliSelect input[type="checkbox"]').on('click', function () { var title = $(this).parent('.mobiconnector-li-dropdown').children('.mobiconnector-label-dropdown').html() + ","; var val = $(this).val(); if (val != 'all') { if ($(this).is(':checked')) { var oldval = $(this).parent('li').parent('ul').parent('.mutliSelect').parent('.mobiconnector-dropdown').children('.list-segment').val(); var newval = oldval + title; $(this).parent('li').parent('ul').parent('.mutliSelect').parent('.mobiconnector-dropdown').children('.list-segment').val(newval); } else { var oldval = $(this).parent('li').parent('ul').parent('.mutliSelect').parent('.mobiconnector-dropdown').children('.list-segment').val(); var newval = oldval.replace(title, ""); $(this).parent('li').parent('ul').parent('.mutliSelect').parent('.mobiconnector-dropdown').children('.list-segment').val(newval); } } }); setTimeout(function (e) { $('.notti-settings-onsignal').hide(); }, 6000); function rgb2hex(rgb) {
        var rgbm = rgb.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?((?:[0-9]*[.])?[0-9]+)[\s+]?\)/i); if (rgbm && rgbm.length === 5) {
            return "#" +
                ('0' + Math.round(parseFloat(rgbm[4], 10) * 255).toString(16).toUpperCase()).slice(-2) +
                ("0" + parseInt(rgbm[1], 10).toString(16).toUpperCase()).slice(-2) +
                ("0" + parseInt(rgbm[2], 10).toString(16).toUpperCase()).slice(-2) +
                ("0" + parseInt(rgbm[3], 10).toString(16).toUpperCase()).slice(-2);
        } else {
            var rgbm = rgb.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i); if (rgbm && rgbm.length === 4) {
                return "#" +
                    ("0" + parseInt(rgbm[1], 10).toString(16).toUpperCase()).slice(-2) +
                    ("0" + parseInt(rgbm[2], 10).toString(16).toUpperCase()).slice(-2) +
                    ("0" + parseInt(rgbm[3], 10).toString(16).toUpperCase()).slice(-2);
            } else { return "cant parse that"; }
        }
    }
    function hexToRgb(hex, opacity) {
        var h = hex; h = h.match(new RegExp('(.{' + h.length / 3 + '})', 'g')); for (var i = 0; i < h.length; i++)
            h[i] = parseInt(h[i].length == 1 ? h[i] + h[i] : h[i], 16); if (typeof opacity != 'undefined') h.push(opacity); return 'rgba(' + h.join(',') + ')';
    }
    $('#mobiconnector-web-title-color-notification').change(function () { var hex = $(this).val(); var rgb = hexToRgb(hex, 1); var hex1 = rgb2hex(rgb); var hex2 = hex1.replace('#', ''); $('#mobiconnector-privew-title-text').css('color', rgb); $('#hidden-web-title-color-response-notification').val(hex); $('#hidden-web-title-color-notification').val(hex2); }); $('#mobiconnector-web-content-color-notification').change(function () { var hex = $(this).val(); var rgb = hexToRgb(hex, 1); var hex1 = rgb2hex(rgb); var hex2 = hex1.replace('#', ''); $('#mobiconnector-privew-content-text').css('color', rgb); $('#hidden-web-content-color-response-notification').val(hex); $('#hidden-web-content-color-notification').val(hex2); }); $('#mobiconnector-web-led-color-notification').change(function () { var hex = $(this).val(); var rgb = hexToRgb(hex, 1); var hex1 = rgb2hex(rgb); var hex2 = hex1.replace('#', ''); $('#hidden-web-led-color-response-notification').val(hex); $('#hidden-web-led-color-notification').val(hex2); }); $('#mobiconnector-web-accent-color-notification').change(function () { var hex = $(this).val(); var rgb = hexToRgb(hex, 1); var hex1 = rgb2hex(rgb); var hex2 = hex1.replace('#', ''); $('#hidden-web-accent-color-response-notification').val(hex); $('#hidden-web-accent-color-notification').val(hex2); }); $('#mobiconnector-button-delete-file').click(function (e) { if (confirm('Are you sure you want to delete this thing?')) { $('#mobiconnector-web-icon-notification').val(''); $('#mobiconnector-icon-web-browser').removeAttr('src'); $('#mobiconnector-button-delete-file').css('display', 'none'); $('#mobiconnector-preview-icon').css('display', 'none'); $('#mobiconnector-preview-icon').css('display', 'none'); $('#mobiconnector-preview-icon').attr('src', ''); $('#mobiconnector-preview-icon-notification').removeClass('exicon'); $('#mobiconnector-preview-text-notification').removeClass('exicon'); } else { return false; } })
    $('#mobiconnector-button-delete-bigimages').click(function (e) { if (confirm('Are you sure you want to delete this thing?')) { $('#mobiconnector-web-bigimages-notification').val(''); $('#mobiconnector-bigimages-web-browser').removeAttr('src'); $('#mobiconnector-button-delete-bigimages').css('display', 'none'); $('#big-images-preview').attr('src', ''); $('#mobiconnector-big-images-previews').removeClass('switchImages'); $('#mobiconnector-preview-icon-notification.small').addClass('switchImages'); $('#mobiconnector-preview-text-notification.small').addClass('switchImages'); $('#click-open-big-images').css('display', 'none'); } else { return false; } })
    $('#mobiconnector-button-delete-bgimages').click(function (e) { if (confirm('Are you sure you want to delete this thing?')) { $('#mobiconnector-web-bgimages-notification').val(''); $('#mobiconnector-bgimages-web-browser').removeAttr('src'); $('#mobiconnector-button-delete-bgimages').css('display', 'none'); $('#mobiconnector-preview-notification').css('background-image', ''); $('#title-small-icon-notification').removeClass('bgpreviews'); $('#mobiconnector-preview-icon-notification').removeClass('bgpreviews'); $('#mobiconnector-big-images-previews').removeClass('bgpreviews'); } else { return false; } })
    $('#mobiconnector-button-delete-smfile').click(function (e) { if (confirm('Are you sure you want to delete this thing?')) { $('#mobiconnector-web-smicon-notification').val(''); $('#mobiconnector-smicon-web-browser').removeAttr('src'); $('#mobiconnector-button-delete-smfile').css('display', 'none'); $('#title-small-icon-notification').css('display', 'none'); $('#mobiconnector-small-icon').attr('src', ''); $('#mobiconnector-preview-icon-notification').removeClass('small'); $('#mobiconnector-privew-title-text').removeClass('small'); $('#mobiconnector-privew-content-text').removeClass('small'); $('#mobiconnector-preview-text-notification').removeClass('small'); if ($('#mobiconnector-big-images-previews').hasClass('switchImages')) { } else { if ($('#mobiconnector-web-bigimages-notification').val() == null || $('#mobiconnector-web-bigimages-notification').val() == '') { } else { $('#mobiconnector-big-images-previews').addClass('switchImages'); } } } else { return false; } })
    var custom_uploader; $('#mobiconnector-button-input-file').click(function (e) {
        var img_input = $('#mobiconnector-web-icon-notification'); e.preventDefault(); if (custom_uploader) { custom_uploader.open(); return; }
        custom_uploader = wp.media.frames.file_frame = wp.media({ title: 'Save Image', button: { text: 'Save Image' }, multiple: false }); custom_uploader.on('select', function () { var selection = custom_uploader.state().get('selection'); selection.map(function (attachment) { attachment = attachment.toJSON(); var url = attachment.url; var checkimage = url.split('.').pop().toUpperCase(); if (checkimage.length < 1) { return false; } else if (checkimage != "PNG" && checkimage != "JPG" && checkimage != "GIF" && checkimage != "JPEG") { alert("invalid extension " + checkimage); return false; } else { img_input.val(url); $('#mobiconnector-icon-web-browser').attr('src', url); $('#mobiconnector-preview-icon').css('display', 'block'); $('#mobiconnector-preview-icon').attr('src', url); $('#mobiconnector-button-delete-file').css('display', 'block'); $('#mobiconnector-preview-icon-notification').addClass('exicon'); $('#mobiconnector-preview-text-notification').addClass('exicon'); } }); }); custom_uploader.open(); return false;
    }); var custom_uploader_images; $('#mobiconnector-button-input-bigimages').click(function (e) {
        var image_input = $('#mobiconnector-web-bigimages-notification'); e.preventDefault(); if (custom_uploader_images) { custom_uploader_images.open(); return; }
        custom_uploader_images = wp.media.frames.file_frame = wp.media({ title: 'Save Image', button: { text: 'Save Image' }, multiple: false }); custom_uploader_images.on('select', function () { var selection = custom_uploader_images.state().get('selection'); selection.map(function (attachment) { attachment = attachment.toJSON(); var urlbigimages = attachment.url; var checkimage = urlbigimages.split('.').pop().toUpperCase(); if (checkimage.length < 1) { return false; } else if (checkimage != "PNG" && checkimage != "JPG" && checkimage != "GIF" && checkimage != "JPEG") { alert("invalid extension " + checkimage); return false; } else { image_input.val(urlbigimages); $('#mobiconnector-bigimages-web-browser').attr('src', urlbigimages); $('#mobiconnector-button-delete-bigimages').css('display', 'block'); $('#big-images-preview').attr('src', urlbigimages); $('#mobiconnector-big-images-previews').addClass('switchImages'); $('#click-open-big-images').css('display', 'block'); $('#mobiconnector-preview-icon-notification').removeClass('switchImages'); $('#mobiconnector-preview-text-notification').removeClass('switchImages'); } }); }); custom_uploader_images.open(); return false;
    }); var custom_uploader_bg; $('#mobiconnector-button-input-bgimages').click(function (e) {
        var bg_input = $('#mobiconnector-web-bgimages-notification'); e.preventDefault(); if (custom_uploader_bg) { custom_uploader_bg.open(); return; }
        custom_uploader_bg = wp.media.frames.file_frame = wp.media({ title: 'Save Image', button: { text: 'Save Image' }, multiple: false }); custom_uploader_bg.on('select', function () { var selection = custom_uploader_bg.state().get('selection'); selection.map(function (attachment) { attachment = attachment.toJSON(); var urlbgimages = attachment.url; var checkimage = urlbgimages.split('.').pop().toUpperCase(); if (checkimage.length < 1) { return false; } else if (checkimage != "PNG" && checkimage != "JPG" && checkimage != "GIF" && checkimage != "JPEG") { alert("invalid extension " + checkimage); return false; } else { bg_input.val(urlbgimages); $('#mobiconnector-bgimages-web-browser').attr('src', urlbgimages); $('#mobiconnector-button-delete-bgimages').css('display', 'block'); $('#mobiconnector-preview-notification').css('background-image', 'url(' + urlbgimages + ')'); $('#title-small-icon-notification').addClass('bgpreviews'); $('#mobiconnector-preview-icon-notification').addClass('bgpreviews'); $('#mobiconnector-big-images-previews').addClass('bgpreviews'); } }); }); custom_uploader_bg.open(); return false;
    }); var custom_smuploader; $('#mobiconnector-button-input-smfile').click(function (e) {
        var smimg_input = $('#mobiconnector-web-smicon-notification'); e.preventDefault(); if (custom_smuploader) { custom_smuploader.open(); return; }
        custom_smuploader = wp.media.frames.file_frame = wp.media({ title: 'Save Image', button: { text: 'Save Image' }, multiple: false }); custom_smuploader.on('select', function () { var selection = custom_smuploader.state().get('selection'); selection.map(function (attachment) { attachment = attachment.toJSON(); var urlsm = attachment.url; var checkimage = urlsm.split('.').pop().toUpperCase(); if (checkimage.length < 1) { return false; } else if (checkimage != "PNG" && checkimage != "JPG" && checkimage != "GIF" && checkimage != "JPEG") { alert("invalid extension " + checkimage); return false; } else { smimg_input.val(urlsm); $('#mobiconnector-smicon-web-browser').attr('src', urlsm); $('#mobiconnector-button-delete-smfile').css('display', 'block'); $('#title-small-icon-notification').css('display', 'block'); $('#mobiconnector-small-icon').attr('src', urlsm); $('#mobiconnector-preview-icon-notification').addClass('small switchImages'); $('#mobiconnector-privew-title-text').addClass('small'); $('#mobiconnector-privew-content-text').addClass('small'); $('#mobiconnector-preview-text-notification').addClass('small switchImages'); } }); }); custom_smuploader.open(); return false;
    });
})